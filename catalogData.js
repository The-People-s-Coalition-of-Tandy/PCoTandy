const albumList = [
  {
    cover: "./Assets/Albums/midi2022/cover/cover2bluebordershadow.png",
    color: "pink",
    name: "30th Anniversary GM Smoidi Light General Midi Competition",
    artists: "Various",
    description: `The People’s Coalition of TANDY “GM General Midi, 30th Anniversary Warrior of the 30 SMoidi Light 30 ZRainbow Spectrume 2022"
    300 Competition!<br><br>

    The annual celebration of General MIDI has borne fruit!<br><br>

    10 tracks,<br>
    10 remixes,<br>
    and 10 General Midi compatible files!<br><br>

    History time:<br>
    The competition takes place in the Spring every year because March 7th is the MID-POINT between Ikutaru Kakehashi 's (from Roland) and Dave Smith's (from Sequential Circuits) birthdays<br>
    This competition is meant to honor and spread appreciation<br>
    for their dedicated work, along with all of those at the Japan MIDI Standards Committee(JMSC) and the American MIDI Manufacturers Association(MMA) !`,
    credits: [
      {
        name: "",
        contribution: `Congrats to our Grand Prize Winners of this year 's The People’s Coalition of TANDY “GM General Midi, 30th Anniversary Warrior of the 30 SMoidi Light 30 ZRainbow Spectrume 2022" 300 Competition!<br>
      <br>
      And congratulations to all of our Category Award Winners :<br><br>
  
        Devotional Category Award Winner: RAMPTOE)(GENIUS IS KAT MAZUR<br><br>
  
      Vocal Performance Category Award Winner: Oratorical Orator<br><br>
  
      Experimental Category Award Winner: Joe Misterovich<br><br>
  
      Chamber Music Award Winner: raef<br><br>
  
      Excellence in Solo Composition Award Winner: Emiliano Cruz<br><br>
  
      Cinematic Award Winner: Opus Impetus<br><br>
  
      Watercolors Award Winner: Scuzz McGuzz<br><br>
  
      Audio Engineering Award Winner: 31i3`,
      },
    ],
    links: [
      {
        label: "Bandcamp",
        link: "https://tandy.bandcamp.com/album/30th-anniversary-gm-smoidi-light-zrainbow-spectrume-2022-general-midi-competition",
        background: "teal",
        font: "white",
      },
      {
        label: "Spotify",
        link: "https://open.spotify.com/album/0eKj2UEuCP32Qh52KGV5jg?si=7D7aRkmzTEK5y53-uZi8zw",
        background: "greenyellow",
        font: "black",
      },
    ],
  },

  {
    cover: "./Assets/Albums/tclr/tclr.jpg",
    color: "purple",
    name: "Tetso Cube Light Ride",
    artists: "elie mcafee-hahn",
    description: "We call ourselves tandy so people know who we are",
    credits: [
      {
        name: "elie mcafee-hahn",
        contribution: "everything",
      },
      {
        name: "Ko T. C.",
        contribution: "Mastering",
      },
    ],
    links: [
      {
        label: "Bandcamp",
        link: "https://tandy.bandcamp.com/album/tetso-cube-lightride",
        background: "teal",
        font: "white",
      },
      {
        label: "instagram",
        link: "https://www.instagram.com/ellie_modron_kurfwen",
        background: "greenyellow",
        font: "black",
      },
      {
        label: "TCLR Visualizer",
        link: "https://tclr.pcotandy.org",
        background: "black",
        font: "white",
      },
      {
        label: "OS Visualizer",
        link: "https://os.pcotandy.org",
        background: "white",
        font: "black",
      },
    ],
  },
  {
    cover: "./Assets/Centre Street/stpCover.jpg",
    color: "greenyellow",
    name: "Star Palm Tree",
    artists: "Sam Walters",
    description: `"Let's get lost inside"<br><br>
        In August's twilight, secret bard Sam Walters emerges to lament our ancient founders, having written of what's now, what's then, and what's to come shakily but Shurely into a naked diary—bound by 7 years of dreams, boundless love and fear.<br><br>
        
        The disappearing ink sinks from page to page, wetting with wist and longing the parchment.<br><br>
        
        The soaked book dries from its extravagant, twisted shapes into warm, familiar cloth—every stage inscribed into the seams as harmonics in the soul of a bell. Neither method nor madness could stir the flutter of the heart like hummingbird wings in each character's tentative steps towards the beautiful, dreadful evening.`,
    credits: [
      {
        name: "Sam Walters",
        contribution: "Music",
      },
      {
        name: "Joohee Park",
        contribution: "Cover Art",
      },
      {
        name: "Ko T. C. & Sam Walters",
        contribution: "Mixing",
      },
      {
        name: "elie mcafee-hahn",
        contribution: "Mastering",
      },
    ],
    links: [
      {
        label: "Full Album",
        link: "https://tandy.bandcamp.com/album/centre-st",
        background: "pink",
        font: "black",
      },
      {
        label: "Bandcamp",
        link: "https://tandy.bandcamp.com/track/star-palm-tree-2",
        background: "teal",
        font: "white",
      },
      {
        label: "Spotify",
        link: "https://open.spotify.com/track/7ebVcs5NtXhk2T1HtzzGHC?si=55fd079613f54122",
        background: "greenyellow",
        font: "black",
      },
      {
        label: "Apple Music",
        link: "https://music.apple.com/tr/album/star-palm-tree-single/1629615027",
        background: "black",
        font: "white",
      },
      {
        label: "Youtube",
        link: "https://www.youtube.com/watch?v=2ZijDc9cyBw",
        background: "white",
        font: "black",
      },
    ],
  },
  {
    cover: "./Assets/Centre Street/anotherDayCover.jpg",
    color: "greenyellow",
    name: "Another Day",
    artists: "Sam Walters",
    description: `Secret bard Sam Walters has returned with his latest incantation from the upcoming album, Centre St.<br><br>

    In the face great peril, you must now choose your own destiny. Will you rise to the occasion? Will the sands of regret be deposited back into your broken hourglass, renewed as crystals of possibility? Or will the cold crescendo of time wash us back to familiar shores?
    <br><br>
    Only you can decide…`,
    credits: [
      {
        name: "Sam Walters",
        contribution: "Music",
      },
      {
        name: "Tuesday Hamilton",
        contribution: "Cover Art",
      },
      {
        name: "Julie Bodian",
        contribution: "Visualizer",
      },
      {
        name: "Ko T. C. & Sam Walters",
        contribution: "Mixing",
      },
      {
        name: "elie mcafee-hahn",
        contribution: "Mastering",
      },
    ],
    links: [
      {
        label: "Full Album",
        link: "https://tandy.bandcamp.com/album/centre-st",
        background: "pink",
        font: "black",
      },
      {
        label: "Bandcamp",
        link: "https://tandy.bandcamp.com/track/another-day",
        background: "teal",
        font: "white",
      },
      {
        label: "Spotify",
        link: "https://open.spotify.com/album/5zPhWDnFkYXk3XJpR0VUqm?si=7H8gkrZ5SwapnzhYjXWhSw ",
        background: "greenyellow",
        font: "black",
      },
      {
        label: "Apple Music",
        link: "https://music.apple.com/us/album/another-day-single/1631687479",
        background: "black",
        font: "white",
      },
      {
        label: "Visualizer",
        link: "https://www.pcotandy.org/visualizers/anotherDay ",
        background: "white",
        font: "black",
      },
    ],
  },
  {
    cover: "./Assets/Centre Street/centreStCover.jpg",
    color: "greenyellow",
    name: "Centre St.",
    artists: "Sam Walters",
    description: `Sam Walters is a songwriter, recordist, nurse-in-training, and long time Coalition member based in Brooklyn, NY. Centre St was recorded with love and meticulous care over the course of 6 years and we are so happy that this deeply personal document of life is out in the world.`,
    credits: [
      {
        name: "Sam Walters",
        contribution: "Music",
      },
      {
        name: "Ko T. C. & Sam Walters",
        contribution: "Mixing",
      },
      {
        name: "elie mcafee-hahn",
        contribution: "Mastering",
      },
    ],
    links: [
      {
        label: "Bandcamp",
        link: "https://tandy.bandcamp.com/album/centre-st",
        background: "teal",
        font: "white",
      },
      {
        label: "Spotify",
        link: "https://open.spotify.com/album/0W6ULIDs7xSPl0S5ShY68C?si=Bxl4svvuSHm-y6kcV0DEmQ&nd=1",
        background: "greenyellow",
        font: "black",
      },
      {
        label: "Apple Music",
        link: "https://music.apple.com/us/album/centre-st/1643794151",
        background: "black",
        font: "white",
      },
    ],
  },
  {
    cover: "./Assets/Albums/tuesdayCover.png",
    color: "purple",
    name: "Tuesday's Universe",
    artists: "Tuesday Hamilton",
    description:
      "A virtual art gallery by Tuesday Hamilton, presented On-Line by a subset of the PCoTandy Web Division",
    credits: [
      {
        name: "Tuesday Hamilton",
        contribution: "art",
      },
      {
        name: "elie mcafee-hahn",
        contribution: "website",
      },
      {
        name: "<a href='https://tuesdaysuni.pcotandy.org/credits.html'>Various Artists</a>",
        contribution: "music",
      },
    ],
    links: [
      {
        label: "website",
        link: "https://tuesdaysuni.pcotandy.org/",
        background: "teal",
        font: "white",
      },
    ],
  },
  {
    cover: "./Assets/Albums/Nick Bisceglia/Slow Gold/SlowGoldCover.png",
    name: "Slow Gold",
    color: "#ffffff",
    artists: "Nick Bisceglia",
    description:
      "✼ ✼ ✼ ✼ ✼ ✼ ✼ ✼ ✼ ✼ ✼ ✼ ✼ ✼ ✼ ✼<br><br>\"I'm loath to quit the task of helping Nick realize these settings, so a few words before our ship sails to soften the blow of its leaving: for months, a few miles upriver from Emily's town, I saw the poetry working on him. Oftentimes I would find him in his study without so much as a candle lit, a full moon casting its negative shadow over jumbles of papers and experiments, singing softly by the window. Had I not been there to guide him through the ruggedest part of the journey (bouts of melancholy, brain fever, fits, etc.), the project surely would have failed. We were fortunate enough to leave that outermost place with what seventeen minutes of material we found. What else can be said of Emily's poetry that hasn't yet? The quaintness belies its extremity - to be touched by it is to apprehend Eternity.\"<br><br>-Bugnu, October 2022",
    contribution: "daguerreotype provided by",
    label: "Blamscamp",
    link: "https://pcotandy.itch.io/slow-gold",
    background: "#c59eff",
    font: "#000000",
    credits: [
      {
        name: "Emily Dickinson",
        contribution: "poetry",
      },
      {
        name: "Nick Bisceglia",
        contribution: "music",
      },
      {
        name: "Bugnu",
        contribution: "production",
      },
      {
        name: "elie",
        contribution: "mastering",
      },
      {
        name: "Amherst College Archives and Special Collections",
        contribution: "daguerreotype",
      },
    ],
    links: [
      {
        label: "Bandcamp",
        link: "https://tandy.bandcamp.com/album/slow-gold",
        background: "#75d1ff",
        font: "#000000",
      },
      {
        label: "Bisceglia Net",
        link: "https://nickbisceglia.pcotandy.org",
        background: "#c59eff",
        font: "#000000",
      },
    ],
  },
  {
    cover: "./Assets/Albums/Ko T.C./LandsEnd/LandsEnd_Cover.jpg",
    name: "Lands End",
    color: "#651d87",
    artists: "Ko T. C.",
    description: "Written in Guilford, Vermont.\n\n",
    contribution: "Mastering",
    label: "Apple Music",
    link: "https://music.apple.com/us/artist/ko-t-c/1503270360",
    background: "#004730",
    font: "#bed5c4",
    credits: [
      {
        name: "<a href='https://scottieharvey.com/'>Scottie Harvey</a>",
        contribution: "Video direction",
      },
      {
        name: "<a href='https://www.shalemarcoloma.com/'>Shalemar Coloma</a>",
        contribution: "Video animation",
      },
      {
        name: "<a href='https://jooheepark.com/'>Joohee Park</a>",
        contribution: "Cover art",
      },
      {
        name: "Heather Jones @ <a href='https://sobig.studio/'>So Big Auditory</a>",
        contribution:
          "Mastering <br><br> <iframe width='90%' height='auto' style='border: 6px ridge #651d87' src='https://www.youtube-nocookie.com/embed/X3XpQz00XVc?controls=0' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe>",
      },
    ],
    links: [
      {
        label: "Youtube",
        link: "https://www.youtube.com/watch?v=X3XpQz00XVc",
        background: "#83089b",
        font: "#0400ff",
      },
      {
        label: "Spotify",
        link: "spotify:album:6kDTIofgNBfk6FB4ppnpFe",
        background: "#2b00ff",
        font: "#e77bcd",
      },
      {
        label: "Bandcamp",
        link: "https://tandy.bandcamp.com/track/lands-end",
        background: "#1a8399",
        font: "#ffffff",
      },
      {
        label: "Soundcloud",
        link: "https://soundcloud.com/pcotandy/ko-t-c-lands-end/s-kAaHNC9bzou?si=03102d183480432b86284ca2e8560540&utm_source=clipboard&utm_medium=text&utm_campaign=social_sharing",
        background: "#000000",
        font: "#ff0000",
      },
      {
        label: "Apple Music",
        link: "https://music.apple.com/us/artist/ko-t-c/1503270360",
        background: "#004730",
        font: "#bed5c4",
      },
    ],
  },
];

function showContent(e) {
  var currentActive = document.querySelector(".active-album");

  if (currentActive) {
    currentActive.classList.remove("active-album");
  }

  var x = e.classList.add("active-album");
}

function spanify(text) {
  const maxLength = 21;
  let result = "";
  for (let i = 0; i < Math.min(text.length, maxLength); i++) {
    text[i] === " "
      ? (result += `<span>&nbsp</span>`)
      : (result += `<span>${text[i]}</span>`);
  }
  if (text.length > maxLength) {
    for (let j = 0; j < 3; j++) {
      result += `<span>.</span>`;
    }
  }

  return result;
}

function generateCatalog() {
  var output = "";
  var item = "";
  albumList.forEach((album, i) => {
    const releaseNumber = `${"0".repeat(
      3 - (Math.log10((i ^ (i >> 31)) - (i >> 31)) | 0)
    )}${i.toString}`;
    item = "";
    item += `
    <li id="PCoT${i + 1}-desktop" onclick="showContent(this)">
      <div class="release-list-text">
        <div class="catalog-number" tabindex="${i}"><p>PCoT 000${
      i + 1
    }</p></div>
        <div class="animate four"><span class="first-span">▣</span>${
          spanify && spanify(album.name)
        }<span class="last-span">▣</span></div>
      </div>
      <div class="line-draw" />

      <div class="album-expansion">
        <div class="img-container"><img src="${album.cover}"></div>
        <div class="album-info-section ${album.color}">
          <h1 class="title">${album.name}</h1>
          <h4 class="artist-name">${album.artists}</h4>
          <div class="album-copy-container">
          <p class="album-copy">${album.description}</p>
          <p class="album-credits">${album.credits}</p>
          </div>
          <div class="links">
            <div class="buttons">`;
    album.links.forEach((link) => {
      item += `<a target='_blank' style="color:${link.font}; background-color:${link.background}" href='${link.link}'>${link.label}</a>`;
    });

    item += `</div>
          </div>
        </div>
      </div>
    </li>`;
    output = item + output;
  });

  output = `<ul>${output}</ul>`;
  document.getElementById("catalog-container").innerHTML = output;
  VanillaTilt.init(document.querySelectorAll(".img-container img"), {
    glare: true,
    perspective: 700,
  });
}

let zindex = 1;
let windows = 0;

function generateNewCatalog() {
  var output = "";
  var item = "";
  albumList.forEach((album, i) => {
    // const releaseNumber = `${'0'.repeat(3-(Math.log10((i ^ (i >> 31)) - (i >> 31)) | 0))}${i.toString}`;
    item = "";
    item += `           
    <div class="release" onclick="addWindow(this)">
      <div class="qube-perspective spin">
        <ul class="qube faces no-shading cube10">
            <!-- Source order implies the faces here! -->
            <li><img src=".${album.cover}"></li>
            <li><img src=".${album.cover}"></li>
            <li><img src=".${album.cover}"></li>
            <li><img src=".${album.cover}"></li>
            <li><img src=".${album.cover}"></li>
            <li><img src=".${album.cover}"></li>
        </ul>
      </div>
      <div class="release-name">
        <p>${album.name}</p>
      </div>
    </div>
`;
    output = item + output;
  });

  document.getElementById("catalog-list").innerHTML = output;
}

function addWindow(release) {
  var output = "";

  const releaseName = release.children[1].children[0].innerText;
  let releaseNumber;

  const windowDiv = document.createElement("div");
  windowDiv.classList.add("window");

  for (let i = 0; i < albumList.length; i++) {
    if (albumList[i].name === releaseName) {
      releaseNumber = `PCoT ${"0".repeat(
        3 - (Math.log10(((i + 1) ^ ((i + 1) >> 31)) - ((i + 1) >> 31)) | 0)
      )}${(i + 1).toString()}`;

      windowDiv.id = releaseNumber.replace(" ", "");
      output += `           
        <header>${releaseNumber} <div class="close ${releaseNumber.replace(
        " ",
        ""
      )}" onclick="closeWindow(this)">X</div></header>
        <div class="release-info">
        <img width="30%" src="${albumList[i].cover}">
          <h2>${albumList[i].name}</h2>
          <h3>${albumList[i].artists}</h3>
          <p>${albumList[i].description}</p>
          <p class="credits">`;

      albumList[i].credits.forEach((credit) => {
        output += `<strong>${credit.name}</strong> - ${credit.contribution}<br>`;
      });
      output += `</p>
        </div>
        <div class="links">`;
      albumList[i].links.forEach((link) => {
        output += `<a target='_blank' style="color:${link.font}; background-color:${link.background}" href='${link.link}'>${link.label}</a>`;
      });
      output += "</div>";
      break;
    }
  }

  const existingWindow = document.getElementById(
    releaseNumber.replace(" ", "")
  );
  if (existingWindow) {
    existingWindow.remove();
  }

  windowDiv.innerHTML = output;
  windowDiv.style.zIndex = zindex;
  windowDiv.style.transform = `translate(calc(-50% + ${
    25 * windows
  }px),calc(-50% + ${25 * windows}px))`;
  zindex++;
  windows++;
  document.getElementById("main").appendChild(windowDiv);

  dragElement(document.getElementById(releaseNumber.replace(" ", "")));
}

function closeWindow(window) {
  document.getElementById(`${window.classList[1]}`).remove();
  windows--;
}

function dragElement(elmnt) {
  var pos1 = 0,
    pos2 = 0,
    pos3 = 0,
    pos4 = 0;
  if (document.getElementById(elmnt.id).children[0]) {
    /* if present, the header is where you move the DIV from:*/
    document.getElementById(elmnt.id).children[0].onmousedown = dragMouseDown;
  } else {
    /* otherwise, move the DIV from anywhere inside the DIV:*/
    elmnt.onmousedown = dragMouseDown;
  }

  function dragMouseDown(e) {
    e = e || window.event;
    e.preventDefault();
    // get the mouse cursor position at startup:
    pos3 = e.clientX;
    pos4 = e.clientY;
    document.onmouseup = closeDragElement;
    // call a function whenever the cursor moves:
    document.onmousemove = elementDrag;
  }

  function elementDrag(e) {
    e = e || window.event;
    e.preventDefault();
    // calculate the new cursor position:
    pos1 = pos3 - e.clientX;
    pos2 = pos4 - e.clientY;
    pos3 = e.clientX;
    pos4 = e.clientY;
    // set the element's new position:
    elmnt.style.zIndex = zindex + 1;
    zindex++;
    elmnt.style.top = elmnt.offsetTop - pos2 + "px";
    elmnt.style.left = elmnt.offsetLeft - pos1 + "px";
  }

  function closeDragElement() {
    /* stop moving when mouse button is released:*/
    document.onmouseup = null;
    document.onmousemove = null;
  }
}
